<div fxLayout="column">
  <section class="bg-white-2" fxLayoutAlign="center" fxLayout="row">
    <div class="container" fxLayout="column">
      <app-search-form></app-search-form>
    </div>
  </section>

  <section
    class="bg-purple-2"
    fxLayoutAlign="center"
    fxLayout="row"
    *ngIf="!(response | async)?.results?.length && !(city | async)"
  >
    <div class="container" fxLayout="column" fxLayoutGap="18px">
      <app-h2>
        Sua pesquisa não encontrou nenhum conteúdo correspondente
      </app-h2>
      <p>
        Confira a grafia das palavras, tentes outros termos ou palavras mais
        genéricas
      </p>
    </div>
  </section>

  <section
    class="bg-purple-2"
    fxLayoutAlign="center"
    fxLayout="row"
    *ngIf="city | async as territory"
  >
    <div class="container" fxLayout.xs="column" fxLayoutGap.xs="36px">
      <div fxLayout="row" fxFlex="40%" fxFlex.xs fxLayoutGap="12px">
        <mat-icon svgIcon="check"></mat-icon>
        <div fxLayout="column" fxLayoutGap="16px">
          <p>{{ territory.territory_name }}</p>
          <p>Nível {{ territory.level }} de acesso</p>
        </div>
      </div>

      <div fxLayout="column" fxFlex="60%" fxFlex.xs fxLayoutGap="18px">
        <p>
          {{ getLevelDescriptionForTerritory(territory.level).text }}
        </p>
        <button
          *ngIf="getLevelDescriptionForTerritory(territory.level).button?.text"
        >
          {{ getLevelDescriptionForTerritory(territory.level).button?.text }}
        </button>
      </div>
    </div>
  </section>

  <div *ngIf="response | async as searchResult">
    <section
      class="bg-purple-2"
      fxLayoutAlign="center"
      fxLayout="row"
      *ngIf="searchResult.count > 0"
    >
      <div class="container" fxLayout="column" fxLayoutGap="42px">
        <p>
          Cras sit amet nibh libero, in gravida nulla. Nulla vel metus
          scelerisque ante sollicitudin commodo.
        </p>
        <div fxLayout="row" fxLayoutAlign="space-between">
          <app-h2>{{ searchResult.count }} resultados encontrados</app-h2>
          <app-select
            [label]="'ORDENAR POR'"
            [options]="orderOptions"
          ></app-select>
        </div>

        <pagination-template
          #p="paginationApi"
          *ngFor="
            let result of searchResult.results
              | paginate
                : {
                    itemsPerPage: 3,
                    currentPage: page,
                    totalItems: searchResult.count
                  }
          "
        >
          <div
            fxLayout="column"
            class="bg-white-2 result color-purple-1"
            fxLayoutGap="22px"
          >
            <p>{{ result.text }}</p>
            <div
              fxLayout="row"
              fxLayout.xs="column"
              fxLayoutAlign="space-between"
            >
              <p>
                {{ result.updatedAt }} •
                <span class="color-purple-3">{{ result.city }}</span>
              </p>
              <app-select
                [theme]="'theme-dark'"
                (onSelected)="openFile($event)"
                [options]="[
                  {
                    value: 'http://path/to/text',
                    viewValue: 'Baixar txt'
                  },
                  {
                    value: 'http://path/to/original',
                    viewValue: 'Baixar arquivo original'
                  }
                ]"
                [label]="'Baixar diário oficial'"
              ></app-select>
            </div>
          </div>
        </pagination-template>
        <div fxLayout="row" fxFlexAlign="center">
          <a class="pagination-first-page">
            <mat-icon svgIcon="pagination-left-double-arrow"></mat-icon>
          </a>
          <a class="pagination-first-page">
            <mat-icon svgIcon="pagination-left-single-arrow"></mat-icon>
          </a>
          <pagination-controls
            (pageChange)="pageChange($event)"
            previousLabel=""
            [maxSize]="3"
            nextLabel=""
            [responsive]="true"
          >
          </pagination-controls>
          <a class="pagination-first-page">
            <mat-icon svgIcon="pagination-right-single-arrow"></mat-icon>
          </a>
          <a class="pagination-first-page">
            <mat-icon svgIcon="pagination-right-double-arrow"></mat-icon>
          </a>
        </div>

        <!-- <div class="custom-pagination">
          <div class="pagination-previous">
            <a (click)="p.previous()"> < </a>
          </div>

          <div
            *ngFor="let page of p.pages"
            [class.current]="p.getCurrent() === page.value"
          >
            <a
              (click)="p.setCurrent(page.value)"
              *ngIf="p.getCurrent() !== page.value"
            >
              <span>{{ page.label }}</span>
            </a>
            <div *ngIf="p.getCurrent() === page.value">
              <span>{{ page.label }}</span>
            </div>
          </div>

          <div class="pagination-next" [class.disabled]="p.isLastPage()">
            <a *ngIf="!p.isLastPage()" (click)="p.next()"> > </a>
          </div>
        </div> -->

        <!--<pagination-controls
          id="some_id"
          (pageChange)="pageChange($event)"
          (pageBoundsCorrection)="pageChange($event)"
          [maxSize]="9"
          [directionLinks]="true"
          [autoHide]="true"
          [responsive]="true"
          previousLabel="Previous"
          nextLabel="Next"
          screenReaderPaginationLabel="Pagination"
          screenReaderPageLabel="page"
          screenReaderCurrentLabel="You're on page"
        >
        </pagination-controls>-->
      </div>
    </section>
  </div>
</div>
